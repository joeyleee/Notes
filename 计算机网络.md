* [一、网络基础知识](#一、网络基础知识)
    * [OSI七层模型](#OSI七层模型)
    * [TCP/IP模型](#TCP/IP模型)
    * [TCP的三次握手](#TCP的三次握手)
# 一、网络基础知识
## OSI七层模型
1. 物理层：用于传输比特流，定制一些网线的标准，网卡工作在这层。
2. 数据链路层：将比特流转变成逻辑传输线路，格式化数据确保传输正确性，完整性，传输单位是帧，交换机工作在这层。
3. 网络层：将网络地址翻译成对应的物理地址，控制数据的路由选择路由器属于网络层，传输单位是数据包，ip协议。
4. 传输层：接受上层数据，在必要的时候把数据进行分割，且保证数据能够到达远端，tcp和udp协议。
5. 会话层：建立和管理应用程序之间的通信，确保应用程序之间能够收发数据包
6. 表示层：解决不同系统之间通信和语法问题，对数据进行格式化。
7. 应用层：规定数据的发送方的数据格式，确保接收方能够识别数据，http协议。
## TCP/IP模型
1. 链路层：物理层和数据链路层。
2. 网络层：网络层。
3. 传输层：传输层。
4. 应用层：会话层，表示层，应用层（HTTP,FTP,SMTPDNS,TELNET...）。
## TCP的三次握手
1. 传输控制协议TCP:面向连接的，可靠的，基于字节流的传输层协议。
2. 将应用层的数据流分割成报文段然后发给目标节点TCP层。
3. 数据包有序号，对方收到则发送ACK确认，未收到重传。
4. 使用校验和来检验数据在传输过程中是否有误。
5. TCP的报文头：源端口和目的端口，seq序号，ack确认号，TCP flags，滑动窗口大小，校验和，紧急指针，TCP可选项
6. TCP flags：
<div align=center>

标志|含义
---|:--:
ACK|确认序号标志
SYN|同步序号标志，用于建立连接过程
FIN|finish标志，用于释放连接
</div>

7. 三次握手:第一次握手，客户端发送SYN包到服务器，进入SYN_SEND状态，等待确认；第二次握手，服务器收到SYN包，自己发送一个SYN+ACK包，此时进入SYN_RECV状态；第三次握手，客户端收到服务器SYN+ACK包，返回一个ACK确认宝，此时握手完毕进入ESTABLISHED状态，建立连接。

<div align=center>

![三次握手](pics/1.jpg)
</div>

8. 为什么需要三次握手：为了初始化sequence number的初始值
9. 首次握手的隐患--SYN超时：server收到client的SYN，回复SYN-ACK的时候未收到ACK确认，server不端重试直至超时。
10. 针对SYN Flood的防护措施：SYN队列满了后，通过tcp_syncookies参数回发SYN cookie，若为正常连接会回发SYN cookie,直接建立连接，而恶意链接不会回复。
11. 建立连接后，客户端出现故障怎么办：通过保活机制，向对方发送保活探测报文，若未收到响应，继续发送，达到尝试次数仍未收到响应，则中断连接。

